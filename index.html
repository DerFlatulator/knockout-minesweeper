<!doctype html>
<html>
    <head>
        <title>Knockout Minesweeper</title>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1">
        
        <style type="text/css">
            section {
                /*max-width: 1200px;*/
                margin: 0 auto;
                text-align: center;
            }
            header {
                font-size: 4em;
                font-weight: bold;
                color: yellow;
                height: 80px;
            }
            header img {
                cursor: pointer;
                height: 64px;
            }
            body {
                background: lightgrey;
                font-family: Arial, Helvetica, sans-serif;               
                margin-left: 1em;                
            }
            * {
                box-sizing: border-box;
            }
            main {
                display: inline-block;
            }
            .cell-row {
                margin: 0 !important;
                padding: 0 !important;
                display: table-row;
            }
            .cell {
                height: 40px;
                max-height: 40px !important;
                width: 40px;
                max-width: 40px;
                background: #BABABA;
                text-align: center;
                display: table-cell;
                margin: 0 !important;
                padding: 0 !important;
                border: 6px outset lightgrey;
                font-size: 24px;       
                text-overflow: hidden;      
                cursor: pointer;   
                vertical-align: middle;
            }
            .revealed {
                border: 1px solid grey !important;
                cursor: default;
            }
            .cell-adjacent-1 {
                color: blue;
            }
            .cell-adjacent-2 {
                color: green;
            }
            .cell-adjacent-3 {
                color: red;
            }
            .cell-adjacent-4 {
                color: darkblue;
            }
            .cell-adjacent-5 {
                color: darkred;
            }
            .cell-adjacent-6 {
                color: darkturquoise;
            }
            .cell-adjacent-7 {
                color: black;
            }
            .cell-adjacent-9 {
                color: #444;
            }
            .flagged {
                color: red;
                cursor: not-allowed !important;
                font-size: 90%;
            }
            .mine.flagged {
                color: red;
            }
            a {
                text-decoration: none;
            }
            ul {
                list-style-position: inside;
                margin-left: -30px !important;
            }
        </style>
        
        <script src="node_modules/knockout/build/output/knockout-latest.debug.js"></script>
        <script src="node_modules/lodash/lodash.js"></script>
        <script src="build/minesweeper.js"></script>
    </head>
    <body>
        <section>
            <h1>Minesweeper</h1>
            <!-- ko ifnot: started -->
            <h4 style="display: inline">Difficulty:</h4>
            <select id=difficulty data-bind="options: difficulties,
                                             optionsText: 'name',
                                             value: selectedDifficulty"></select>
            <button id=start data-bind="click: start">Start</button>
            <!-- /ko -->
            <!-- ko if: started -->
                <!-- ko with: grid -->
                    <header> 
                        <img data-bind="attr: { src: gameState },
                                        click: $parent.reset" />
                    </header>
                    Flags left: <span data-bind="text: flagsRemaining"></span> | 
                    Mines: <span data-bind="text: difficulty.mines"></span> <br/>
                    <main data-bind="foreach: cellRows">
                    <div class="cell-row" data-bind="foreach: $data">
                        <div href="#" class="cell" 
                            data-bind="html: cellText(),
                                      css: cellCss(),                                        
                                      event: { contextmenu: flag, mousedown: suspense, mouseup: relief },
                                      click: reveal"></div>
                    </div>
                    </main>
                <!-- /ko -->
                <br />
                <footer>              
                    <h4>How to play</h4>
                    <ul>
                        <li>Left click to sweep.</li>
                        <li>Right click to add or remove a flag.</li>
                        <li>Click the face to reset.</li>
                        <li>Click <a href="#" data-bind="click: hardReset">here</a> to change difficulty.</li>
                    </ul>
                </footer>
            <!-- /ko -->
        </section>        
    </body>
</html>